{% extends "base.html" %}

{% block title %}Dashboard â€” Custora AI{% endblock %}

{% block extra_css %}
<style>
  /* ============================================================
     DASHBOARD PAGE STYLES
  ============================================================ */

  .page-body > .container {
    padding-top: 0;
    max-width: 1200px;
  }

  /* â”€â”€ Section spacing â”€â”€ */
  .dash-section {
    padding: 64px 0;
    position: relative;
  }

  .dash-section + .dash-section {
    border-top: 1px solid var(--border);
  }

  /* â”€â”€ Section label â”€â”€ */
  .ds-label {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    font-size: 0.7rem;
    font-weight: 700;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 10px;
  }

  .ds-label::before {
    content: '';
    display: block;
    width: 16px; height: 2px;
    border-radius: 1px;
    background: var(--brand-gradient);
  }

  /* ============================================================
     1. WELCOME HERO
  ============================================================ */
  .welcome-hero {
    padding: 72px 0 64px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  /* Radial background pulse */
  .welcome-hero::before {
    content: '';
    position: absolute;
    top: -40%;
    left: 50%;
    transform: translateX(-50%);
    width: 600px; height: 400px;
    background: radial-gradient(ellipse,
      rgba(155,45,202,0.10) 0%,
      rgba(247,37,133,0.05) 50%,
      transparent 70%);
    pointer-events: none;
  }

  .welcome-hero > * { position: relative; z-index: 1; }

  .welcome-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 5px 14px 5px 8px;
    background: var(--bg-surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-pill);
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 24px;
    letter-spacing: 0.02em;
  }

  .welcome-badge-dot {
    width: 20px; height: 20px;
    border-radius: 50%;
    background: var(--brand-gradient);
    display: grid;
    place-items: center;
    flex-shrink: 0;
  }

  .welcome-badge-dot::after {
    content: '';
    width: 7px; height: 7px;
    border-radius: 50%;
    background: white;
  }

  .welcome-h1 {
    font-size: clamp(2rem, 5vw, 3.25rem);
    font-weight: 800;
    letter-spacing: -0.05em;
    line-height: 1.1;
    color: var(--text-primary);
    margin-bottom: 14px;
  }

  .welcome-h1 .username {
    background: var(--brand-gradient-text);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .welcome-sub {
    font-size: 1.05rem;
    color: var(--text-secondary);
    max-width: 480px;
    margin: 0 auto 36px;
    line-height: 1.65;
  }

  .welcome-cta-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 14px;
    flex-wrap: wrap;
  }

  /* Upload CTA */
  .btn-upload {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 13px 28px;
    background: var(--brand-gradient);
    color: #fff;
    border: none;
    border-radius: var(--radius-pill);
    font-family: var(--font-family);
    font-size: 0.95rem;
    font-weight: 700;
    text-decoration: none;
    letter-spacing: 0.01em;
    cursor: pointer;
    box-shadow: var(--shadow-btn);
    transition: transform 0.18s ease, box-shadow 0.18s ease;
    position: relative;
    overflow: hidden;
  }

  .btn-upload::before {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(255,255,255,0);
    transition: background 0.18s ease;
  }

  .btn-upload:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 40px rgba(247,37,133,0.45);
    color: #fff;
  }

  .btn-upload:hover::before { background: rgba(255,255,255,0.07); }
  .btn-upload:active         { transform: translateY(0); }

  .btn-upload-icon {
    width: 22px; height: 22px;
    border-radius: 50%;
    background: rgba(255,255,255,0.2);
    display: grid;
    place-items: center;
    flex-shrink: 0;
  }

  .btn-ghost-sm {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 12px 20px;
    background: transparent;
    color: var(--text-secondary);
    border: 1px solid var(--border);
    border-radius: var(--radius-pill);
    font-family: var(--font-family);
    font-size: 0.875rem;
    font-weight: 600;
    text-decoration: none;
    transition: color var(--transition), border-color var(--transition), background var(--transition), transform 0.18s ease;
  }

  .btn-ghost-sm:hover {
    color: var(--text-primary);
    border-color: var(--border-accent);
    background: var(--bg-surface);
    transform: translateY(-1px);
  }

  /* ============================================================
     2. MODEL METRICS CARDS
  ============================================================ */
  .metrics-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 18px;
    margin-top: 36px;
  }

  .metric-card {
    background: var(--bg-surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 26px 24px;
    position: relative;
    overflow: hidden;
    transition: border-color var(--transition), box-shadow var(--transition), transform 0.2s ease;
    cursor: default;
  }

  .metric-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    background: var(--brand-gradient);
    opacity: 0;
    transition: opacity var(--transition);
  }

  .metric-card:hover {
    border-color: var(--border-accent);
    box-shadow: var(--shadow-glow), var(--shadow-card);
    transform: translateY(-3px);
  }

  .metric-card:hover::before { opacity: 1; }

  .metric-card-icon {
    width: 42px; height: 42px;
    border-radius: var(--radius-md);
    background: linear-gradient(135deg,
      rgba(247,37,133,0.12), rgba(67,97,238,0.12));
    border: 1px solid var(--border-accent);
    display: grid;
    place-items: center;
    font-size: 1.2rem;
    margin-bottom: 16px;
  }

  .metric-value {
    font-size: 2.1rem;
    font-weight: 800;
    letter-spacing: -0.05em;
    line-height: 1;
    background: var(--brand-gradient-text);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    display: block;
    margin-bottom: 4px;
  }

  .metric-value-text {
    font-size: 1rem;
    font-weight: 700;
    letter-spacing: -0.02em;
    line-height: 1.2;
    background: var(--brand-gradient-text);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    display: block;
    margin-bottom: 4px;
  }

  .metric-name {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.07em;
  }

  .metric-pill {
    display: inline-block;
    margin-top: 10px;
    padding: 3px 10px;
    border-radius: var(--radius-pill);
    font-size: 0.66rem;
    font-weight: 700;
    letter-spacing: 0.06em;
    text-transform: uppercase;
  }

  .pill-green  { background: rgba(34,197,94,0.12);  border: 1px solid rgba(34,197,94,0.22);  color: #22c55e; }
  .pill-purple { background: rgba(155,45,202,0.12); border: 1px solid rgba(155,45,202,0.22); color: #9b2dca; }
  .pill-pink   { background: rgba(247,37,133,0.12); border: 1px solid rgba(247,37,133,0.22); color: #f72585; }
  .pill-blue   { background: rgba(67,97,238,0.12);  border: 1px solid rgba(67,97,238,0.22);  color: #4361ee; }

  /* ============================================================
     3. VISUALIZATION SECTION
  ============================================================ */
  .viz-grid {
    display: grid;
    grid-template-columns: 1fr 1.7fr;
    gap: 20px;
    margin-top: 36px;
  }

  .viz-card {
    background: var(--bg-surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 28px;
    box-shadow: var(--shadow-card);
    transition: border-color var(--transition), box-shadow var(--transition);
    position: relative;
    overflow: hidden;
  }

  .viz-card:hover {
    border-color: var(--border-accent);
    box-shadow: var(--shadow-glow), var(--shadow-card);
  }

  .viz-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 24px;
  }

  .viz-card-title {
    font-size: 0.95rem;
    font-weight: 700;
    letter-spacing: -0.02em;
    color: var(--text-primary);
  }

  .viz-card-badge {
    display: inline-block;
    padding: 3px 10px;
    border-radius: var(--radius-pill);
    font-size: 0.65rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.07em;
    background: rgba(34,197,94,0.12);
    border: 1px solid rgba(34,197,94,0.22);
    color: #22c55e;
  }

  /* â”€â”€ DONUT CHART â”€â”€ */
  .donut-wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
  }

  .donut-svg-wrap {
    position: relative;
    width: 180px; height: 180px;
    flex-shrink: 0;
  }

  .donut-svg {
    transform: rotate(-90deg);
    width: 180px; height: 180px;
  }

  .donut-track {
    fill: none;
    stroke: var(--bg-elevated);
    stroke-width: 18;
  }

  .donut-seg {
    fill: none;
    stroke-width: 18;
    stroke-linecap: round;
    transition: stroke-dashoffset 1.2s cubic-bezier(0.34,1.2,0.64,1);
  }

  .donut-center {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .donut-center-val {
    font-size: 1.55rem;
    font-weight: 800;
    letter-spacing: -0.04em;
    background: var(--brand-gradient-text);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1;
  }

  .donut-center-lbl {
    font-size: 0.62rem;
    font-weight: 700;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-top: 2px;
  }

  .donut-legend {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .legend-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 0.8rem;
  }

  .legend-left {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--text-secondary);
    font-weight: 500;
  }

  .legend-dot {
    width: 10px; height: 10px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .legend-pct {
    font-weight: 700;
    color: var(--text-primary);
    font-size: 0.82rem;
  }

  /* â”€â”€ LINE CHART â”€â”€ */
  .line-chart-wrap { position: relative; }

  .line-chart-svg {
    width: 100%;
    height: 200px;
    overflow: visible;
  }

  .chart-grid-line {
    stroke: var(--border);
    stroke-width: 1;
    stroke-dasharray: 4 4;
  }

  .chart-area {
    opacity: 0.15;
    transition: opacity var(--transition);
  }

  .viz-card:hover .chart-area { opacity: 0.22; }

  .chart-line {
    fill: none;
    stroke-width: 2.5;
    stroke-linecap: round;
    stroke-linejoin: round;
  }

  .chart-dot {
    transition: r 0.2s ease;
    cursor: pointer;
  }

  .chart-dot:hover { r: 6; }

  .chart-x-labels {
    display: flex;
    justify-content: space-between;
    margin-top: 8px;
    padding: 0 4px;
  }

  .chart-x-label {
    font-size: 0.68rem;
    color: var(--text-muted);
    font-weight: 500;
  }

  .chart-y-labels {
    position: absolute;
    left: 0; top: 0;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 200px;
    pointer-events: none;
  }

  .chart-y-label {
    font-size: 0.63rem;
    color: var(--text-muted);
    font-weight: 500;
    transform: translateX(-8px);
    text-align: right;
    min-width: 32px;
  }

  .chart-legend {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-top: 16px;
    flex-wrap: wrap;
  }

  .chart-legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-secondary);
  }

  .chart-legend-line {
    width: 20px; height: 3px;
    border-radius: 2px;
  }

  /* Tooltip */
  .chart-tooltip {
    position: absolute;
    background: var(--bg-elevated);
    border: 1px solid var(--border-accent);
    border-radius: var(--radius-md);
    padding: 8px 12px;
    font-size: 0.78rem;
    font-weight: 600;
    color: var(--text-primary);
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s ease;
    white-space: nowrap;
    box-shadow: var(--shadow-card);
    z-index: 10;
  }

  /* ============================================================
     4. PRICING SECTION
  ============================================================ */
  .pricing-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-top: 36px;
    align-items: start;
  }

  .pricing-card {
    background: var(--bg-surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-xl);
    padding: 32px 28px;
    position: relative;
    transition: border-color var(--transition), box-shadow var(--transition), transform 0.2s ease;
  }

  .pricing-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-card);
  }

  /* Pro â€” highlighted */
  .pricing-card.is-pro {
    border-color: var(--border-accent);
    background: linear-gradient(160deg,
      rgba(247,37,133,0.05) 0%,
      rgba(155,45,202,0.05) 50%,
      rgba(67,97,238,0.05) 100%);
    box-shadow: var(--shadow-glow), var(--shadow-card);
    transform: scale(1.03);
  }

  .pricing-card.is-pro:hover {
    transform: scale(1.03) translateY(-4px);
    box-shadow: 0 0 60px rgba(155,45,202,0.22), var(--shadow-card);
  }

  /* Pro top gradient border */
  .pricing-card.is-pro::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    background: var(--brand-gradient);
    border-radius: var(--radius-xl) var(--radius-xl) 0 0;
  }

  /* Popular badge */
  .pricing-popular-badge {
    position: absolute;
    top: -13px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--brand-gradient);
    color: #fff;
    font-size: 0.68rem;
    font-weight: 700;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    padding: 4px 14px;
    border-radius: var(--radius-pill);
    white-space: nowrap;
    box-shadow: 0 4px 16px rgba(247,37,133,0.4);
  }

  .pricing-plan-name {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--text-muted);
    margin-bottom: 10px;
  }

  .pricing-price {
    display: flex;
    align-items: baseline;
    gap: 4px;
    margin-bottom: 6px;
  }

  .pricing-price-amount {
    font-size: 2.6rem;
    font-weight: 800;
    letter-spacing: -0.05em;
    color: var(--text-primary);
    line-height: 1;
  }

  .pricing-price-amount.gradient {
    background: var(--brand-gradient-text);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .pricing-price-period {
    font-size: 0.85rem;
    color: var(--text-muted);
    font-weight: 500;
  }

  .pricing-desc {
    font-size: 0.82rem;
    color: var(--text-secondary);
    line-height: 1.55;
    margin-bottom: 24px;
    min-height: 40px;
  }

  .pricing-divider {
    height: 1px;
    background: var(--border);
    margin-bottom: 22px;
  }

  .pricing-features {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 28px;
  }

  .pricing-feature {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    font-size: 0.83rem;
    color: var(--text-secondary);
    line-height: 1.45;
  }

  .feature-check {
    width: 16px; height: 16px;
    border-radius: 50%;
    background: rgba(34,197,94,0.12);
    border: 1px solid rgba(34,197,94,0.22);
    display: grid;
    place-items: center;
    flex-shrink: 0;
    margin-top: 1px;
    font-size: 0.55rem;
    color: #22c55e;
  }

  .feature-check.muted {
    background: var(--bg-elevated);
    border-color: var(--border);
    color: var(--text-muted);
  }

  .pricing-btn {
    display: block;
    width: 100%;
    padding: 12px;
    border-radius: var(--radius-pill);
    font-family: var(--font-family);
    font-size: 0.875rem;
    font-weight: 700;
    text-align: center;
    text-decoration: none;
    cursor: pointer;
    border: none;
    transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
    letter-spacing: 0.01em;
  }

  .pricing-btn:hover { transform: translateY(-2px); }

  .pricing-btn-ghost {
    background: transparent;
    color: var(--text-primary);
    border: 1px solid var(--border);
  }

  .pricing-btn-ghost:hover {
    border-color: var(--border-accent);
    background: var(--bg-elevated);
    color: var(--text-primary);
  }

  .pricing-btn-gradient {
    background: var(--brand-gradient);
    color: #fff;
    box-shadow: var(--shadow-btn);
  }

  .pricing-btn-gradient:hover {
    box-shadow: 0 10px 36px rgba(247,37,133,0.45);
    color: #fff;
  }

  .pricing-btn-outline {
    background: transparent;
    color: var(--text-secondary);
    border: 1px solid var(--border);
  }

  .pricing-btn-outline:hover {
    border-color: var(--border-accent);
    color: var(--text-primary);
    background: var(--bg-elevated);
  }

  /* ============================================================
     RESPONSIVE
  ============================================================ */
  @media (max-width: 1024px) {
    .metrics-grid { grid-template-columns: repeat(2, 1fr); }
    .viz-grid     { grid-template-columns: 1fr; }
    .pricing-card.is-pro { transform: scale(1); }
    .pricing-card.is-pro:hover { transform: translateY(-4px); }
  }

  @media (max-width: 768px) {
    .dash-section  { padding: 48px 0; }
    .welcome-hero  { padding: 56px 0 48px; }
    .metrics-grid  { grid-template-columns: repeat(2, 1fr); gap: 14px; }
    .pricing-grid  { grid-template-columns: 1fr; max-width: 400px; margin-left: auto; margin-right: auto; }
    .pricing-card.is-pro { transform: scale(1); }
  }

  @media (max-width: 520px) {
    .welcome-h1    { font-size: 1.9rem; }
    .metrics-grid  { grid-template-columns: 1fr 1fr; }
    .metric-value  { font-size: 1.7rem; }
  }
</style>
{% endblock %}


{% block content %}

<!-- ============================================================
     1. WELCOME HERO
============================================================ -->
<section class="welcome-hero fade-up">

  <!-- Status badge -->
  <div class="welcome-badge">
    <div class="welcome-badge-dot"></div>
    Churn Intelligence Active
  </div>

  <!-- Headline â€” Jinja var preserved -->
  <h1 class="welcome-h1">
    Welcome back,<br/>
    <span class="username">{{ current_user.username }}</span>
  </h1>

  <p class="welcome-sub">
    Your churn intelligence workspace. Upload a dataset to generate<br/>
    ML-powered predictions and AI retention strategies.
  </p>

  <!-- CTA row -->
  <div class="welcome-cta-row">
    <a class="btn-upload" href="{{ url_for('main.upload') }}">
      <span class="btn-upload-icon">
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
          <path d="M6 1v7M3 4l3-3 3 3M1 10h10" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </span>
      Upload Dataset
    </a>
    <a class="btn-ghost-sm" href="#">
      View Docs
      <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
        <path d="M3 11L11 3M11 3H6M11 3v5" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </a>
  </div>

</section>


<!-- ============================================================
     2. MODEL CAPABILITY CARDS
============================================================ -->
<section class="dash-section">

  <div class="ds-label">Model Performance</div>
  <h2 style="font-size:1.65rem;font-weight:800;letter-spacing:-0.04em;color:var(--text-primary);margin-bottom:4px;">
    Ensemble ML metrics
  </h2>
  <p style="font-size:0.9rem;color:var(--text-secondary);margin-bottom:0;">
    Validated on holdout test set. Static benchmarks from the latest training run.
  </p>

  <div class="metrics-grid">

    <!-- Accuracy -->
    <div class="metric-card fade-up" style="transition-delay:0.05s">
      <div class="metric-card-icon">ðŸŽ¯</div>
      <span class="metric-value">75.7%</span>
      <div class="metric-name">Accuracy</div>
      <span class="metric-pill pill-green">Validated</span>
    </div>

    <!-- Recall -->
    <div class="metric-card fade-up" style="transition-delay:0.1s">
      <div class="metric-card-icon">ðŸ“¡</div>
      <span class="metric-value">80.4%</span>
      <div class="metric-name">Recall</div>
      <span class="metric-pill pill-purple">Churn Class</span>
    </div>

    <!-- F1 Score -->
    <div class="metric-card fade-up" style="transition-delay:0.15s">
      <div class="metric-card-icon">âš¡</div>
      <span class="metric-value">0.64</span>
      <div class="metric-name">F1 Score</div>
      <span class="metric-pill pill-blue">Balanced</span>
    </div>

    <!-- Revenue Impact Engine -->
    <div class="metric-card fade-up" style="transition-delay:0.2s">
      <div class="metric-card-icon">ðŸ’°</div>
      <span class="metric-value-text">Revenue Impact Engine</span>
      <div class="metric-name">AI Strategy</div>
      <span class="metric-pill pill-pink">Enabled</span>
    </div>

  </div>
</section>


<!-- ============================================================
     3. VISUALIZATION SECTION
============================================================ -->
<section class="dash-section">

  <div class="ds-label">Analytics</div>
  <h2 style="font-size:1.65rem;font-weight:800;letter-spacing:-0.04em;color:var(--text-primary);margin-bottom:4px;">
    Churn &amp; revenue overview
  </h2>
  <p style="font-size:0.9rem;color:var(--text-secondary);margin-bottom:0;">
    Sample visualizations. Upload a dataset to generate real predictions.
  </p>

  <div class="viz-grid fade-up">

    <!-- â”€â”€ Donut Chart: Risk Segmentation â”€â”€ -->
    <div class="viz-card">
      <div class="viz-card-header">
        <span class="viz-card-title">Risk Segmentation</span>
        <span class="viz-card-badge">Sample Data</span>
      </div>

      <div class="donut-wrap">
        <!-- SVG Donut -->
        <div class="donut-svg-wrap">
          <svg class="donut-svg" viewBox="0 0 180 180">
            <circle class="donut-track" cx="90" cy="90" r="72"/>

            <!-- High risk: 34% â€” pink -->
            <circle
              class="donut-seg"
              cx="90" cy="90" r="72"
              stroke="url(#segGrad1)"
              stroke-dasharray="154 298"
              stroke-dashoffset="0"
              id="seg-high"
            />
            <!-- Medium risk: 41% â€” purple -->
            <circle
              class="donut-seg"
              cx="90" cy="90" r="72"
              stroke="#9b2dca"
              stroke-dasharray="186 266"
              stroke-dashoffset="-154"
              id="seg-med"
            />
            <!-- Low risk: 25% â€” blue -->
            <circle
              class="donut-seg"
              cx="90" cy="90" r="72"
              stroke="#4361ee"
              stroke-dasharray="113 339"
              stroke-dashoffset="-340"
              id="seg-low"
            />

            <defs>
              <linearGradient id="segGrad1" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%"   stop-color="#f72585"/>
                <stop offset="100%" stop-color="#9b2dca"/>
              </linearGradient>
            </defs>
          </svg>

          <!-- Center label -->
          <div class="donut-center">
            <span class="donut-center-val">452</span>
            <span class="donut-center-lbl">Customers</span>
          </div>
        </div>

        <!-- Legend -->
        <div class="donut-legend">
          <div class="legend-row">
            <div class="legend-left">
              <div class="legend-dot" style="background:#f72585"></div>
              High Risk
            </div>
            <span class="legend-pct">34% â€” 154</span>
          </div>
          <div class="legend-row">
            <div class="legend-left">
              <div class="legend-dot" style="background:#9b2dca"></div>
              Medium Risk
            </div>
            <span class="legend-pct">41% â€” 185</span>
          </div>
          <div class="legend-row">
            <div class="legend-left">
              <div class="legend-dot" style="background:#4361ee"></div>
              Low Risk
            </div>
            <span class="legend-pct">25% â€” 113</span>
          </div>
        </div>
      </div>
    </div>


    <!-- â”€â”€ Line Chart: Revenue Projection â”€â”€ -->
    <div class="viz-card" style="position:relative">
      <div class="viz-card-header">
        <span class="viz-card-title">Revenue Projection</span>
        <span class="viz-card-badge">Sample Data</span>
      </div>

      <div class="line-chart-wrap">

        <!-- Y labels -->
        <div class="chart-y-labels" style="left:-38px">
          <span class="chart-y-label">$120k</span>
          <span class="chart-y-label">$90k</span>
          <span class="chart-y-label">$60k</span>
          <span class="chart-y-label">$30k</span>
          <span class="chart-y-label">$0</span>
        </div>

        <!-- SVG Chart -->
        <svg class="line-chart-svg" viewBox="0 0 600 200" preserveAspectRatio="none" id="revChart">
          <defs>
            <linearGradient id="lineGrad1" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%"   stop-color="#f72585"/>
              <stop offset="100%" stop-color="#4361ee"/>
            </linearGradient>
            <linearGradient id="areaGrad1" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%"   stop-color="#9b2dca" stop-opacity="0.5"/>
              <stop offset="100%" stop-color="#9b2dca" stop-opacity="0"/>
            </linearGradient>
            <linearGradient id="lineGrad2" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%"   stop-color="#4361ee"/>
              <stop offset="100%" stop-color="#22c55e"/>
            </linearGradient>
            <linearGradient id="areaGrad2" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%"   stop-color="#4361ee" stop-opacity="0.35"/>
              <stop offset="100%" stop-color="#4361ee" stop-opacity="0"/>
            </linearGradient>
          </defs>

          <!-- Horizontal grid lines -->
          <line x1="0" y1="0"   x2="600" y2="0"   class="chart-grid-line"/>
          <line x1="0" y1="50"  x2="600" y2="50"  class="chart-grid-line"/>
          <line x1="0" y1="100" x2="600" y2="100" class="chart-grid-line"/>
          <line x1="0" y1="150" x2="600" y2="150" class="chart-grid-line"/>
          <line x1="0" y1="200" x2="600" y2="200" class="chart-grid-line"/>

          <!-- At-risk revenue area (red/purple) -->
          <!-- Points: Jan 90, Feb 95, Mar 85, Apr 100, May 110, Jun 88, Jul 75, Aug 80, Sep 70, Oct 65, Nov 60, Dec 55 -->
          <!-- Scaled: 0â€“120k â†’ 200â€“0px: val/120*200 from top -->
          <path
            class="chart-area"
            fill="url(#areaGrad1)"
            d="M0,50 L54.5,41.7 L109,75 L163.6,33.3 L218.2,16.7 L272.7,60 L327.3,95 L381.8,83.3 L436.4,116.7 L490.9,125 L545.5,133.3 L600,141.7 L600,200 L0,200Z"
          />
          <path
            class="chart-line"
            stroke="url(#lineGrad1)"
            d="M0,50 L54.5,41.7 L109,75 L163.6,33.3 L218.2,16.7 L272.7,60 L327.3,95 L381.8,83.3 L436.4,116.7 L490.9,125 L545.5,133.3 L600,141.7"
          />

          <!-- Retained revenue area (blue/green) -->
          <!-- Higher values: 105,108,115,120,118,112,110,115,118,122,125,128 -->
          <path
            class="chart-area"
            fill="url(#areaGrad2)"
            d="M0,25 L54.5,20 L109,8.3 L163.6,0 L218.2,3.3 L272.7,13.3 L327.3,16.7 L381.8,8.3 L436.4,3.3 L490.9,-3.3 L545.5,-8.3 L600,-13.3 L600,200 L0,200Z"
          />
          <path
            class="chart-line"
            stroke="url(#lineGrad2)"
            d="M0,25 L54.5,20 L109,8.3 L163.6,0 L218.2,3.3 L272.7,13.3 L327.3,16.7 L381.8,8.3 L436.4,3.3 L490.9,-3.3 L545.5,-8.3 L600,-13.3"
            stroke-dasharray="0"
          />

          <!-- Dots â€” at-risk line -->
          <circle class="chart-dot" cx="0"     cy="50"    r="4" fill="#f72585"/>
          <circle class="chart-dot" cx="163.6" cy="33.3"  r="4" fill="#f72585"/>
          <circle class="chart-dot" cx="327.3" cy="95"    r="4" fill="#9b2dca"/>
          <circle class="chart-dot" cx="490.9" cy="125"   r="4" fill="#9b2dca"/>
          <circle class="chart-dot" cx="600"   cy="141.7" r="4" fill="#4361ee"/>
        </svg>

        <!-- X axis labels -->
        <div class="chart-x-labels">
          <span class="chart-x-label">Jan</span>
          <span class="chart-x-label">Feb</span>
          <span class="chart-x-label">Mar</span>
          <span class="chart-x-label">Apr</span>
          <span class="chart-x-label">May</span>
          <span class="chart-x-label">Jun</span>
          <span class="chart-x-label">Jul</span>
          <span class="chart-x-label">Aug</span>
          <span class="chart-x-label">Sep</span>
          <span class="chart-x-label">Oct</span>
          <span class="chart-x-label">Nov</span>
          <span class="chart-x-label">Dec</span>
        </div>

        <!-- Chart legend -->
        <div class="chart-legend">
          <div class="chart-legend-item">
            <div class="chart-legend-line" style="background:linear-gradient(90deg,#f72585,#9b2dca)"></div>
            At-Risk Revenue
          </div>
          <div class="chart-legend-item">
            <div class="chart-legend-line" style="background:linear-gradient(90deg,#4361ee,#22c55e)"></div>
            Retained (w/ Custora)
          </div>
        </div>

      </div>
    </div>

  </div>
</section>


<!-- ============================================================
     4. PRICING SECTION
============================================================ -->
<section class="dash-section">

  <div class="ds-label">Pricing</div>
  <h2 style="font-size:1.65rem;font-weight:800;letter-spacing:-0.04em;color:var(--text-primary);margin-bottom:4px;">
    Scale with your team
  </h2>
  <p style="font-size:0.9rem;color:var(--text-secondary);margin-bottom:0;">
    Start free. Upgrade when you need AI-generated retention strategies and deeper insights.
  </p>

  <div class="pricing-grid fade-up">

    <!-- FREE -->
    <div class="pricing-card">
      <div class="pricing-plan-name">Free</div>
      <div class="pricing-price">
        <span class="pricing-price-amount">$0</span>
        <span class="pricing-price-period">/ month</span>
      </div>
      <p class="pricing-desc">Perfect for exploring Custora AI with a small dataset.</p>

      <div class="pricing-divider"></div>

      <div class="pricing-features">
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          Up to 500 customer records
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          Basic churn score report
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          3-tier risk segmentation
        </div>
        <div class="pricing-feature">
          <span class="feature-check muted">â€”</span>
          <span style="color:var(--text-muted)">AI retention strategies</span>
        </div>
        <div class="pricing-feature">
          <span class="feature-check muted">â€”</span>
          <span style="color:var(--text-muted)">PDF report export</span>
        </div>
        <div class="pricing-feature">
          <span class="feature-check muted">â€”</span>
          <span style="color:var(--text-muted)">Revenue impact engine</span>
        </div>
      </div>

      <a href="{{ url_for('main.upload') }}" class="pricing-btn pricing-btn-ghost">
        Get started free
      </a>
    </div>

    <!-- PRO (highlighted) -->
    <div class="pricing-card is-pro">
      <div class="pricing-popular-badge">Most Popular</div>
      <div class="pricing-plan-name" style="color:var(--brand-pink)">Pro</div>
      <div class="pricing-price">
        <span class="pricing-price-amount gradient">$49</span>
        <span class="pricing-price-period">/ month</span>
      </div>
      <p class="pricing-desc">Full ML pipeline with AI strategies and PDF exports for growing teams.</p>

      <div class="pricing-divider"></div>

      <div class="pricing-features">
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          Unlimited customer records
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          Full ensemble churn scoring
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          3-tier risk segmentation
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          Claude AI retention strategies
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          PDF report export
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          Revenue impact engine
        </div>
      </div>

      <a href="{{ url_for('main.upload') }}" class="pricing-btn pricing-btn-gradient">
        Upgrade to Pro â†’
      </a>
    </div>

    <!-- ENTERPRISE -->
    <div class="pricing-card">
      <div class="pricing-plan-name">Enterprise</div>
      <div class="pricing-price">
        <span class="pricing-price-amount">Custom</span>
      </div>
      <p class="pricing-desc">Dedicated infrastructure, custom integrations, and SLA guarantees.</p>

      <div class="pricing-divider"></div>

      <div class="pricing-features">
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          Everything in Pro
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          Custom ML model retraining
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          CRM &amp; Salesforce integration
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          Dedicated account manager
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          99.9% uptime SLA
        </div>
        <div class="pricing-feature">
          <span class="feature-check">âœ“</span>
          SSO &amp; audit logs
        </div>
      </div>

      <a href="#" class="pricing-btn pricing-btn-outline">
        Contact sales
      </a>
    </div>

  </div>
</section>


<!-- ============================================================
     BOTTOM CTA STRIP
============================================================ -->
<section class="dash-section" style="padding-bottom: 80px;">
  <div style="
    background: linear-gradient(135deg,
      rgba(247,37,133,0.07) 0%,
      rgba(155,45,202,0.07) 50%,
      rgba(67,97,238,0.07) 100%);
    border: 1px solid var(--border-accent);
    border-radius: var(--radius-xl);
    padding: 52px 40px;
    text-align: center;
    position: relative;
    overflow: hidden;
  " class="fade-up">

    <!-- Top gradient line -->
    <div style="
      position:absolute; top:0; left:0; right:0;
      height:2px;
      background: var(--brand-gradient);
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
    "></div>

    <div class="ds-label" style="justify-content:center;margin-bottom:16px;">Ready to start?</div>
    <h2 style="
      font-size:clamp(1.5rem,3.5vw,2.2rem);
      font-weight:800;
      letter-spacing:-0.04em;
      color:var(--text-primary);
      margin-bottom:10px;
    ">
      Stop guessing. Start predicting.
    </h2>
    <p style="
      font-size:0.95rem;
      color:var(--text-secondary);
      max-width:440px;
      margin: 0 auto 28px;
      line-height:1.65;
    ">
      Upload your customer CSV and receive AI-generated churn predictions
      and retention strategies in under 60 seconds.
    </p>

    <div class="welcome-cta-row">
      <a class="btn-upload" href="{{ url_for('main.upload') }}">
        <span class="btn-upload-icon">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
            <path d="M6 1v7M3 4l3-3 3 3M1 10h10" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
        Upload Dataset Now
      </a>
    </div>

  </div>
</section>

{% endblock %}


{% block extra_js %}
<script>
  /* â”€â”€ Donut chart animation on scroll â”€â”€ */
  const donutSegs = document.querySelectorAll('.donut-seg');
  let donutAnimated = false;

  const donutObserver = new IntersectionObserver((entries) => {
    if (entries[0].isIntersecting && !donutAnimated) {
      donutAnimated = true;
      /* Segments start from dashoffset 452 (full circumference) and animate to their target */
      const circumference = 2 * Math.PI * 72; /* â‰ˆ 452.4 */
      donutSegs.forEach(seg => {
        const currentOffset = parseFloat(seg.getAttribute('stroke-dashoffset') || '0');
        seg.style.transition = 'none';
        seg.setAttribute('stroke-dasharray', `0 ${circumference}`);
        seg.setAttribute('stroke-dashoffset', currentOffset);
        requestAnimationFrame(() => {
          requestAnimationFrame(() => {
            seg.style.transition = 'stroke-dasharray 1.1s cubic-bezier(0.34,1.2,0.64,1)';
            /* Restore originals */
            const targets = ['154 298', '186 266', '113 339'];
            donutSegs.forEach((s, i) => {
              s.setAttribute('stroke-dasharray', targets[i]);
            });
          });
        });
      });
      donutObserver.disconnect();
    }
  }, { threshold: 0.3 });

  const vizSection = document.querySelector('.viz-grid');
  if (vizSection) donutObserver.observe(vizSection);

  /* â”€â”€ Metric card counter animation â”€â”€ */
  function animateCount(el, target, isFloat, suffix) {
    const duration = 1200;
    const start    = performance.now();
    const from     = 0;

    function step(now) {
      const progress = Math.min((now - start) / duration, 1);
      const ease     = 1 - Math.pow(1 - progress, 3);
      const val      = from + (target - from) * ease;

      if (isFloat) {
        el.textContent = val.toFixed(2);
      } else {
        el.textContent = val.toFixed(1) + suffix;
      }

      if (progress < 1) requestAnimationFrame(step);
    }
    requestAnimationFrame(step);
  }

  const metricObserver = new IntersectionObserver((entries) => {
    if (entries[0].isIntersecting) {
      setTimeout(() => {
        animateCount(document.querySelector('[data-val="75.7"]'), 75.7, false, '%');
        animateCount(document.querySelector('[data-val="80.4"]'), 80.4, false, '%');
        animateCount(document.querySelector('[data-val="0.64"]'), 0.64, true, '');
      }, 150);
      metricObserver.disconnect();
    }
  }, { threshold: 0.3 });

  const metricsGrid = document.querySelector('.metrics-grid');
  if (metricsGrid) {
    metricObserver.observe(metricsGrid);

    /* Tag elements for counter targeting */
    const vals = metricsGrid.querySelectorAll('.metric-value');
    if (vals[0]) vals[0].setAttribute('data-val', '75.7');
    if (vals[1]) vals[1].setAttribute('data-val', '80.4');
    if (vals[2]) vals[2].setAttribute('data-val', '0.64');
  }

  /* â”€â”€ Fade-up observer (re-run for dashboard elements) â”€â”€ */
  const fadeEls = document.querySelectorAll('.fade-up:not(.visible)');
  const fadeDashObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        fadeDashObserver.unobserve(entry.target);
      }
    });
  }, { threshold: 0.08, rootMargin: '0px 0px -20px 0px' });

  fadeEls.forEach(el => fadeDashObserver.observe(el));
</script>
{% endblock %}